# Claude Code 作業指示書

## プロジェクト概要
これはNotion連携の予約システムです。ReactとNetlify Functionsを使用してNotionデータベースと連携しています。

## 初期セットアップ

### 1. リポジトリのクローン
Claude Codeに以下を指示：
```
GitHubから https://github.com/tttsystem/apokanri.git をクローンして、初期セットアップを行ってください
```

### 2. 環境構築
```
npm installを実行して依存関係をインストールしてください
```

## Git設定

### リポジトリ情報
- **GitHub URL**: https://github.com/tttsystem/apokanri.git
- **メインブランチ**: main
- **プッシュ先**: origin/main

### Gitコマンド例
Claude Codeに指示する際の例：
```
変更をコミットしてGitHubにプッシュしてください
```

Claude Codeが自動的に以下を実行します：
```bash
git add .
git commit -m "適切なコミットメッセージ"
git push origin main
```

## 主要ファイルと役割

### フロントエンド
- `src/components/NotionBookingSystem.jsx` - メインの予約システムコンポーネント
  - 予約フォーム
  - カレンダー表示
  - 時間スロット管理

### バックエンド（Netlify Functions）
- `netlify/functions/notion-query.js` - Notionデータベースからデータ取得
- `netlify/functions/notion-create.js` - Notionに新規予約を作成

### 設定値の場所
`src/components/NotionBookingSystem.jsx`内：
- **36行目**: `CALENDAR_DATABASE_ID` - NotionデータベースID
- **20-26行目**: システム設定（営業時間など）
- **29-34行目**: 祝日リスト
- **147行目**: 対応者ID

## よくある作業指示

### 1. 営業時間を変更したい場合
```
NotionBookingSystem.jsxの営業時間を9時から18時に変更してください
```

### 2. 新しい入力項目を追加したい場合
```
予約フォームに電話番号の入力欄を追加してください（必須項目として）
```

### 3. 祝日を追加したい場合
```
2026年の祝日リストを追加してください
```

### 4. デザインを変更したい場合
```
予約ボタンの色を青から緑に変更してください
```

### 5. バグ修正
```
14:00-17:00のような複数時間の予約が正しくブロックされない問題を修正してください
```

## Notion関連の作業

### データベース構造
現在のNotionデータベースのプロパティ：
- **名前** (title) - 予約者名
- **予定日** (date) - 予約日時
- **X** (url) - XのプロフィールURL
- **備考** (rich_text) - 任意のメモ
- **対応者** (people) - 担当者
- **通話方法** (select) - 対面/オンライン

### 新しいプロパティを追加する場合
1. Notionでデータベースにプロパティを追加
2. Claude Codeに指示：
```
Notionデータベースに「メールアドレス」プロパティを追加したので、
予約フォームにメールアドレス入力欄を追加して、Notionに保存するようにしてください
```

## デバッグとテスト

### ローカルでのテスト
```
npm startでローカルサーバーを起動して動作確認してください
```

### コンソールログの確認
```
ブラウザのコンソールでエラーがないか確認し、問題があれば修正してください
```

### Netlify Functionsのテスト
```
netlify devを使ってローカルでNetlify Functionsをテストしてください
```

## デプロイ

### 自動デプロイ
GitHubにプッシュすると自動的にNetlifyにデプロイされます。

### 手動デプロイが必要な場合
```
npm run buildでビルドを作成し、Netlifyにデプロイしてください
```

## トラブルシューティング指示

### Notionとの連携が動かない場合
```
Notion APIの接続を確認して、エラーがあれば修正してください。
環境変数NOTION_TOKENが正しく設定されているか確認してください。
```

### 予約が重複する場合
```
予約の重複チェックロジックを確認して、
時間帯の重複判定が正しく動作するように修正してください
```

### UIの不具合
```
予約フォームのレイアウトが崩れているので修正してください
```

## 環境変数

### Netlifyで設定済み
- `NOTION_TOKEN` - Notion Integration Token（変更不要）

### ローカル開発用
ローカルで開発する場合は`.env.local`ファイルを作成：
```
NOTION_TOKEN=secret_xxxxxxxxxxxxx
```

## コーディング規約

Claude Codeに指示する際の注意：
1. 既存のコードスタイルに従うよう指示
2. 日本語のコメントやUIテキストを維持
3. エラーハンドリングを適切に行う
4. console.logは本番環境では最小限に

## 作業完了後の確認事項

Claude Codeに以下を確認するよう指示：
```
以下を確認してください：
1. コードにエラーがないか
2. 正しく動作するか
3. 変更内容をコミットしたか
4. GitHubにプッシュしたか
```

## よく使うClaude Code指示例

### 機能追加
```
予約確認メールを送信する機能を追加してください
```

### バグ修正
```
土日が選択できてしまうバグを修正してください
```

### UI改善
```
スマートフォンでの表示を最適化してください
```

### パフォーマンス改善
```
Notionからのデータ取得を高速化してください
```

### セキュリティ
```
入力値のバリデーションを強化してください
```

---

## 重要な注意事項

1. **Notion Token**は絶対にコードに直接書かない
2. **git pushする前に**必ず動作確認をする
3. **大きな変更**の前にはブランチを作成することを推奨
4. **本番環境**への影響を考慮して作業する

## サポート

問題が発生した場合は、GitHubのIssuesまたは社内チャットで連絡してください。

---
最終更新: 2025年1月
作成者による引き継ぎ資料